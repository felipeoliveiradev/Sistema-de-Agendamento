if (self.CavalryLogger) { CavalryLogger.start_js(["cIF0P"]); }

__d("react-relay-deprecated/classic/traversal/flattenRelayQuery",["react-relay-deprecated/classic/query/RelayQuery","react-relay-deprecated/classic/query/RelayQueryVisitor","relay-runtime"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("relay-runtime").RelayProfiler;function a(a,b){var c=new i(b&&b.shouldRemoveFragments),d={node:a,type:a.getType(),flattenedFieldMap:new Map(),flattenedFragmentMap:new Map()};c.traverse(a,d);return h(a,d,!!(b&&b.preserveEmptyNodes))}function h(a,b,c){var d=b.flattenedFieldMap,e=b.flattenedFragmentMap,f=[];b=Array.from(d.keys());b.forEach(function(a){a=d.get(a);a&&f.push(h(a.node,a,c))});Array.from(e.keys()).forEach(function(a){a=e.get(a);a&&f.push(h(a.node,a,c))});return c&&a.canHaveSubselections()&&!f.length?a:a.clone(f)}d=babelHelpers.inherits(i,b("react-relay-deprecated/classic/query/RelayQueryVisitor"));g=d&&d.prototype;function i(a){g.constructor.call(this),this.$RelayQueryFlattener1=!!a}i.prototype.visitFragment=function(a,b){var c=a.getType();if(this.$RelayQueryFlattener1||c===b.type){this.traverse(a,b);return}var d=b.flattenedFragmentMap.get(c);d||(d={node:a,type:c,flattenedFieldMap:new Map(),flattenedFragmentMap:new Map()},b.flattenedFragmentMap.set(c,d));this.traverse(a,d)};i.prototype.visitField=function(a,b){var c=a.getShallowHash(),d=b.flattenedFieldMap.get(c);d||(d={node:a,type:a.getType(),flattenedFieldMap:new Map(),flattenedFragmentMap:new Map()},b.flattenedFieldMap.set(c,d));this.traverse(a,d)};e.exports=c.instrument("flattenRelayQuery",a)}),null);