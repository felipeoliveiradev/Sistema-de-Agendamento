if (self.CavalryLogger) { CavalryLogger.start_js(["JVAqn"]); }

__d("react-relay-deprecated/classic/mutation/RelayMutationQueue",["invariant","ErrorUtils","react-relay-deprecated/classic/network/RelayMutationRequest","react-relay-deprecated/classic/query/fromGraphQL","react-relay-deprecated/classic/query/QueryBuilder","react-relay-deprecated/classic/query/RelayQuery","react-relay-deprecated/classic/traversal/flattenRelayQuery","react-relay-deprecated/classic/mutation/RelayMutationQuery","react-relay-deprecated/classic/mutation/RelayMutationTransaction","react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus","react-relay-deprecated/classic/mutation/RelayOptimisticMutationUtils","base62","nullthrows","relay-runtime","resolveImmediate","react-relay-deprecated/classic/mutation/RelayMutationDebugPrinter"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("relay-runtime").ConnectionInterface,i=0;function a(a){this.$1={},this.$2={},this.$3=[],this.$4=a,this.$5=!1}a.prototype.createTransaction=function(a,b){return this.createTransactionWithPendingTransaction(null,function(c,d){return new j({id:c,mutation:a,mutationTransaction:d,onFailure:b&&b.onFailure,onSuccess:b&&b.onSuccess})})};a.prototype.createTransactionWithPendingTransaction=function(a,c){a||c||g(0,4354);var d=l(),e=new(b("react-relay-deprecated/classic/mutation/RelayMutationTransaction"))(this,d);a=a||c(d,e);this.$2[d]=a;this.$3.push(a);return e};a.prototype.getTransaction=function(a){a=this.$2[a];return a?a.mutationTransaction:null};a.prototype.getError=function(a){return this.$6(a).error};a.prototype.getStatus=function(a){return this.$6(a).status};a.prototype.applyOptimistic=function(a){a=this.$6(a);a.status=b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").UNCOMMITTED;a.error=null;this.$7(a)};a.prototype.commit=function(a){__p&&__p();a=this.$6(a);var c=a.getCollisionKey(),d=c&&this.$1[c];if(d){d.push(a);a.status=b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").COMMIT_QUEUED;a.error=null;return}c&&(this.$1[c]=[a]);this.$8(a)};a.prototype.rollback=function(a){__p&&__p();a=this.$6(a);var b=a.getCollisionKey();if(b){var c=this.$1[b];if(c){var d=c.indexOf(a);d!==-1&&c.splice(d,1);c.length===0&&delete this.$1[b]}}this.$9(a)};a.prototype.$6=function(a){var b=this.$2[a];b||g(0,4355,a);return b};a.prototype.$7=function(a){var b=a.getOptimisticResponse(),c=a.getOptimisticQuery(this.$4);if(b&&c){a=a.getOptimisticConfigs()||a.getConfigs();this.$4.handleUpdatePayload(c,b,{configs:a,isOptimisticUpdate:!0})}};a.prototype.$10=function(a,c){__p&&__p();var d=c?b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").COMMIT_FAILED:b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").COLLISION_COMMIT_FAILED;a.status=d;a.error=c;d=!0;var e=a.onFailure;if(e){var f=function(){d=!1};b("ErrorUtils").applyWithGuard(e,null,[a.mutationTransaction,f],null,"RelayMutationTransaction:onCommitFailure")}c&&this.$11(a);d&&Object.prototype.hasOwnProperty.call(this.$2,a.id)&&this.$9(a);this.$12()};a.prototype.$13=function(a,c){this.$14(a);this.$15(a);this.$16();this.$4.handleUpdatePayload(a.getQuery(this.$4),c[a.getCallName()],{configs:a.getConfigs(),isOptimisticUpdate:!1});a=a.onSuccess;a&&b("ErrorUtils").applyWithGuard(a,null,[c],null,"RelayMutationTransaction:onCommitSuccess")};a.prototype.$8=function(a){a.status=b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").COMMITTING;a.error=null;var c=new(b("react-relay-deprecated/classic/network/RelayMutationRequest"))(a.getQuery(this.$4),a.getFiles());this.$4.getNetworkLayer().sendMutation(c);c.getPromise().then(function(b){return this.$13(a,b.response)}.bind(this),function(b){return this.$10(a,b)}.bind(this))["catch"](function(a){setTimeout(function(){throw a},0)})};a.prototype.$9=function(a){this.$15(a),this.$12()};a.prototype.$15=function(a){delete this.$2[a.id],this.$3=this.$3.filter(function(b){return b!==a})};a.prototype.$14=function(a){a=a.getCollisionKey();if(a){var b=this.$1[a];b&&(b.shift(),b.length?this.$8(b[0]):delete this.$1[a])}};a.prototype.$11=function(a){var b=a.getCollisionKey();if(b){var c=this.$1[b];c&&(c.forEach(function(b){b!==a&&this.$10(b,null)}.bind(this)),delete this.$1[b])}};a.prototype.$12=function(){this.$5||(this.$5=!0,b("resolveImmediate")(function(){this.$5=!1,this.$16()}.bind(this)))};a.prototype.$16=function(){this.$4.clearQueuedData(),this.$3.forEach(function(a){return this.$7(a)}.bind(this))};function j(a){this.error=null,this.id=a.id,this.mutation=a.mutation,this.mutationTransaction=a.mutationTransaction,this.onFailure=a.onFailure,this.onSuccess=a.onSuccess,this.status=b("react-relay-deprecated/classic/mutation/RelayMutationTransactionStatus").CREATED}j.prototype.getCallName=function(){this.$1||(this.$1=this.getMutationNode().calls[0].name);return this.$1};j.prototype.getCollisionKey=function(){this.$2===void 0&&(this.$2=this.mutation.getCollisionKey()||null);return this.$2};j.prototype.getConfigs=function(){this.$3||(this.$3=this.mutation.getConfigs());return this.$3};j.prototype.getFatQuery=function(){if(!this.$5){var a=b("react-relay-deprecated/classic/query/fromGraphQL").Fragment(this.mutation.getFatQuery());a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Fragment||g(0,4356);this.$5=b("nullthrows")(b("react-relay-deprecated/classic/traversal/flattenRelayQuery")(a,{preserveEmptyNodes:!0,shouldRemoveFragments:!0}))}return this.$5};j.prototype.getFiles=function(){this.$6===void 0&&(this.$6=this.mutation.getFiles()||null);return this.$6};j.prototype.getInputVariable=function(){if(!this.$7){var a;a=babelHelpers["extends"]({},this.mutation.getVariables(),(a={},a[h.get().CLIENT_MUTATION_ID]=this.id,a));this.$7=a}return this.$7};j.prototype.getMutationNode=function(){if(!this.$8){var a=b("react-relay-deprecated/classic/query/QueryBuilder").getMutation(this.mutation.getMutation());a||g(0,4357);this.$8=a}return this.$8};j.prototype.getOptimisticConfigs=function(){this.$11===void 0&&(this.$11=this.mutation.getOptimisticConfigs()||null);return this.$11};j.prototype.getOptimisticQuery=function(a){__p&&__p();if(this.$12===void 0){var c=this.$16();if(c){var d=this.getOptimisticConfigs();a=k(a);d?this.$12=b("react-relay-deprecated/classic/mutation/RelayMutationQuery").buildQuery({configs:d,fatQuery:this.getFatQuery(),input:this.getInputVariable(),mutationName:this.mutation.constructor.name,mutation:this.getMutationNode(),tracker:a}):this.$12=b("react-relay-deprecated/classic/mutation/RelayMutationQuery").buildQueryForOptimisticUpdate({response:c,fatQuery:this.getFatQuery(),mutation:this.getMutationNode()})}else this.$12=null}return this.$12};j.prototype.$16=function(){if(this.$15===void 0){var a=this.mutation.getOptimisticResponse()||null;a&&(a[h.get().CLIENT_MUTATION_ID]=this.id);this.$15=a}return this.$15};j.prototype.getOptimisticResponse=function(){if(this.$13===void 0){var a=this.$16();a?this.$13=b("react-relay-deprecated/classic/mutation/RelayOptimisticMutationUtils").inferRelayPayloadFromData(a):this.$13=a}return this.$13};j.prototype.getQuery=function(a){if(!this.$14){a=k(a);this.$14=b("react-relay-deprecated/classic/mutation/RelayMutationQuery").buildQuery({configs:this.getConfigs(),fatQuery:this.getFatQuery(),input:this.getInputVariable(),mutationName:this.getMutationNode().name,mutation:this.getMutationNode(),tracker:a})}return this.$14};function k(a){a=a.getQueryTracker();a||g(0,4358);return a}function l(){return b("base62")(i++)}e.exports=a}),null);