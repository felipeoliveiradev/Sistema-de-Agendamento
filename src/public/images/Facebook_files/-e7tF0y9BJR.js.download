if (self.CavalryLogger) { CavalryLogger.start_js(["+sg7B"]); }

__d("react-relay-deprecated/classic/traversal/diffRelayQuery",["invariant","react-relay-deprecated/classic/interface/RelayNodeInterface","react-relay-deprecated/classic/query/forEachRootCallArg","react-relay-deprecated/classic/query/RelayQuery","react-relay-deprecated/classic/query/RelayQueryPath","react-relay-deprecated/classic/store/RelayRecord","react-relay-deprecated/classic/tools/isCompatibleRelayFragmentType","relay-runtime","warning"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("relay-runtime").ConnectionInterface;c=b("relay-runtime").RelayProfiler;var i=b("react-relay-deprecated/classic/interface/RelayNodeInterface").ID,j=b("react-relay-deprecated/classic/interface/RelayNodeInterface").ID_TYPE,k=b("react-relay-deprecated/classic/interface/RelayNodeInterface").NODE_TYPE;d=b("react-relay-deprecated/classic/interface/RelayNodeInterface").TYPENAME;var l=b("react-relay-deprecated/classic/query/RelayQuery").Field.build({fieldName:i,metadata:{isRequisite:!0},type:"String"}),m=b("react-relay-deprecated/classic/query/RelayQuery").Field.build({fieldName:d,metadata:{isRequisite:!0},type:"String"}),n=b("react-relay-deprecated/classic/query/RelayQuery").Field.build({fieldName:b("react-relay-deprecated/classic/interface/RelayNodeInterface").NODE,children:[l,m],metadata:{canHaveSubselections:!0},type:k});function a(a,c,d){__p&&__p();var e=b("react-relay-deprecated/classic/query/RelayQueryPath").create(a),f=[],h=new o(c,d);d=a.getIdentifyingArg();var i=d&&d.value||null,k=Array.isArray(i)&&i.length>1,l;d!=null&&(l={identifyingArgName:d.name,identifyingArgType:d.type!=null?d.type:j,isAbstract:a.isAbstract(),isDeferred:!1,isPlural:!1});var m=a.getFieldName(),n=a.getStorageKey();b("react-relay-deprecated/classic/query/forEachRootCallArg")(a,function(d){__p&&__p();var i=d.identifyingArgValue;d=d.identifyingArgKey;k?(i!=null||g(0,3121,m),i=b("react-relay-deprecated/classic/query/RelayQuery").Root.build(a.getName(),m,[i],a.getChildren(),l,a.getType())):i=a;d=c.getDataID(n,d);if(d==null){f.push(i);return}d=p(d);i=h.visit(i,e,d);d=i?i.diffNode:null;d&&(d instanceof b("react-relay-deprecated/classic/query/RelayQuery").Root||g(0,3122),f.push(d))});return f.concat(h.getSplitQueries())}function o(a,b){this.$1=a,this.$2=[],this.$3=b}o.prototype.splitQuery=function(a){this.$2.push(a)};o.prototype.getSplitQueries=function(){return this.$2};o.prototype.visit=function(a,c,d){if(a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field)return this.visitField(a,c,d);else if(a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Fragment)return this.visitFragment(a,c,d);else if(a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Root)return this.visitRoot(a,c,d)};o.prototype.visitRoot=function(a,b,c){return this.traverse(a,b,c)};o.prototype.visitFragment=function(a,b,c){return this.traverse(a,b,c)};o.prototype.visitField=function(a,c,d){__p&&__p();var e=d.connectionField,f=d.dataID,g=d.edgeID;d=d.rangeInfo;if(e&&d){var i=h.get(),j=i.EDGES;i=i.PAGE_INFO;if(g)if(a.getSchemaName()===j)return this.diffConnectionEdge(e,a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,g),g,d);else return null;else if(a.getSchemaName()===j||a.getSchemaName()===i)return d.diffCalls.length>0?{diffNode:a,trackedNode:null}:null}if(!a.canHaveSubselections())return this.diffScalar(a,f);else if(a.isGenerated())return{diffNode:a,trackedNode:null};else if(a.isConnection())return this.diffConnection(a,c,f);else if(a.isPlural())return this.diffPluralLink(a,c,f);else return this.diffLink(a,c,f)};o.prototype.traverse=function(a,c,d){__p&&__p();var e,f,g,h,i=!1,j=!1;a.getChildren().forEach(function(a){__p&&__p();if(a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field){var e=this.visitField(a,c,d),g=e?e.diffNode:null;e=e&&this.$3?e.trackedNode:null;g?(f=f||[],f.push(g),i=i||!g.isGenerated()):a.isRequisite()&&!d.rangeInfo&&(f=f||[],f.push(a));this.$3&&(e?(h=h||[],h.push(e),j=j||!e.isGenerated()):a.isRequisite()&&(h=h||[],h.push(a)))}else if(a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Fragment){g=b("react-relay-deprecated/classic/tools/isCompatibleRelayFragmentType")(a,this.$1.getType(d.dataID));if(g){if(a.isTrackingEnabled()){e=a.getCompositeHash();if(this.$1.hasFragmentData(d.dataID,e))return{diffNode:null,trackedNode:null}}g=this.traverse(a,c,d);e=g?g.diffNode:null;g=g?g.trackedNode:null;e&&(f=f||[],f.push(e),i=!0);g&&(h=h||[],h.push(g),j=!0)}else f=f||[],f.push(a)}}.bind(this));f&&i&&(e=a.clone(f));h&&j&&(g=a.clone(h));this.$3&&g&&!(g instanceof b("react-relay-deprecated/classic/query/RelayQuery").Fragment)&&this.$3.trackNodeForID(g,d.dataID);return{diffNode:e,trackedNode:g}};o.prototype.diffScalar=function(a,b){return this.$1.getField(b,a.getStorageKey())===void 0?{diffNode:a,trackedNode:null}:null};o.prototype.diffLink=function(a,c,d){d=this.$1.getLinkedRecordID(d,a.getStorageKey());if(d===void 0)return{diffNode:a,trackedNode:null};return d===null?{diffNode:null,trackedNode:this.$3?a:null}:this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,d),p(d))};o.prototype.diffPluralLink=function(a,c,d){__p&&__p();var e=h.get();e=e.NODE;d=this.$1.getLinkedRecordIDs(d,a.getStorageKey());if(d===void 0)return{diffNode:a,trackedNode:null};else if(d===null||d.length===0)return{diffNode:null,trackedNode:this.$3?a:null};else if(a.getInferredRootCallName()===e){var f=!1;d.forEach(function(d){var e=this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,d),p(d));e&&(f=f||!!e.trackedNode||!!e.diffNode,e.diffNode&&this.splitQuery(r(d,e.diffNode.getChildren(),b("react-relay-deprecated/classic/query/RelayQueryPath").getName(c),a.getType(),a.isAbstract())))}.bind(this));if(f)return{diffNode:null,trackedNode:this.$3?a:null}}else{var g=!1,i=!1;d.some(function(d){d=this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,d),p(d));d&&d.diffNode&&(g=!0);d&&d.trackedNode&&(i=!0);return g&&i}.bind(this));if(g||i)return{diffNode:g?a:null,trackedNode:i?a:null}}return null};o.prototype.diffConnection=function(a,c,d){__p&&__p();var e=this.$1,f=e.getLinkedRecordID(d,a.getStorageKey()),g=e.getRangeMetadata(f,a.getCallsWithValues());if(f===void 0)return{diffNode:a,trackedNode:null};if(f===null)return this.$3?{diffNode:null,trackedNode:a}:null;if(g==null)return this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,f),p(f));d=g.diffCalls;e=g.filteredEdges;var h=!1;e.forEach(function(d){var e={connectionField:a,dataID:f,edgeID:d.edgeID,rangeInfo:g};d=this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,d.edgeID),e);d&&(h=h||!!d.trackedNode)}.bind(this));e={connectionField:a,dataID:f,edgeID:null,rangeInfo:g};e=this.traverse(a,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(c,a,f),e);var i=e?e.diffNode:null;e=e?e.trackedNode:null;d.length&&i instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field&&(i=i.cloneFieldWithCalls(i.getChildren(),d));h&&(e=a);return{diffNode:i,trackedNode:this.$3?e:null}};o.prototype.diffConnectionEdge=function(a,c,d,e,f){__p&&__p();var i=h.get();i=i.NODE;var j=!1,k=this.traverse(c,b("react-relay-deprecated/classic/query/RelayQueryPath").getPath(d,c,e),p(e)),l=k?k.diffNode:null;k=k?k.trackedNode:null;e=this.$1.getLinkedRecordID(e,i);if(l)if(!e||b("react-relay-deprecated/classic/store/RelayRecord").isClientID(e))b("warning")(a.isConnectionWithoutNodeID(),"RelayDiffQueryBuilder: Field `node` on connection `%s` cannot be retrieved if it does not have an `id` field. If you expect fields to be retrieved on this field, add an `id` field in the schema. If you choose to ignore this warning, you can silence it by adding `@relay(isConnectionWithoutNodeID: true)` to the connection field.",a.getStorageKey());else{i=q(l);l=i.edges;i=i.node;if(i){j=!0;var m=c.getFieldByStorageKey("node");m||g(0,3123,a.getSchemaName());this.splitQuery(r(e,i.getChildren(),b("react-relay-deprecated/classic/query/RelayQueryPath").getName(d),m.getType(),m.isAbstract()))}if(l)if(a.isFindable()){l=l.clone(l.getChildren().concat(n));i=a.cloneFieldWithCalls([l],f.filterCalls.concat({name:"find",value:e}));if(i){j=!0;m=b("react-relay-deprecated/classic/query/RelayQueryPath").getParent(b("react-relay-deprecated/classic/query/RelayQueryPath").getParent(d));l=b("react-relay-deprecated/classic/query/RelayQueryPath").getQuery(this.$1,m,i);this.splitQuery(l)}}else b("warning")(!1,"RelayDiffQueryBuilder: connection `edges{*}` fields can only be refetched if the connection supports the `find` call. Cannot refetch data for field `%s`.",a.getStorageKey())}return this.$3?{diffNode:null,trackedNode:j?c:k}:null};function p(a){return{connectionField:null,dataID:a,edgeID:null,rangeInfo:null}}function q(a){__p&&__p();var c=h.get();c=c.NODE;var d=a.getChildren(),e=[],f=null,g=[],j=!1;for(var k=0;k<d.length;k++){var l=d[k];if(l instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field)if(l.getSchemaName()===c){var m=l.getChildren();g=g.concat(m);if(!f)if(m.length===1){m=m[0];(!(m instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field)||m.getSchemaName()!==i)&&(f=l)}else f=l}else e.push(l),j=j||!l.isRequisite();else if(l instanceof b("react-relay-deprecated/classic/query/RelayQuery").Fragment){m=q(l);l=m.edges;m=m.node;l&&(e.push(l),j=!0);m&&(g.push(m),f=m)}}return{edges:j?a.clone(e):null,node:f&&b("react-relay-deprecated/classic/query/RelayQuery").Fragment.build("diffRelayQuery",f.getType(),g,{isAbstract:f.isAbstract()})}}function r(a,c,d,e,f){var g=h.get();g=g.NODE;var n=[l,m],o=[];c.forEach(function(a){a instanceof b("react-relay-deprecated/classic/query/RelayQuery").Field?o.push(a):n.push(a)});n.push(b("react-relay-deprecated/classic/query/RelayQuery").Fragment.build("diffRelayQuery",e,o,{isAbstract:f}));return b("react-relay-deprecated/classic/query/RelayQuery").Root.build(d,g,a,n,{identifyingArgName:i,identifyingArgType:j,isAbstract:!0,isDeferred:!1,isPlural:!1},k)}e.exports=c.instrument("diffRelayQuery",a)}),null);