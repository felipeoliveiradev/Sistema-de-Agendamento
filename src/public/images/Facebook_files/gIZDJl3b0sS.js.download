if (self.CavalryLogger) { CavalryLogger.start_js(["aGXN7"]); }

__d("RelayGraphQLBatchRequest",["invariant","RelayAPIConfig","RelayAPIRequest","RelayGraphQLRequestUtils","RelayRuntime"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("RelayRuntime").RelayError;function i(a,b){this.$1=a,this.$2=null,this.$3={},this.$4=b||"json",this.$5="UNSENT"}i.prototype.add=function(a,b){this.$5==="UNSENT"||g(0,2946);Object.prototype.hasOwnProperty.call(this.$3,a)||(this.$3[a]=b);return this};i.prototype.send=function(a){this.$5==="UNSENT"||g(0,2947);this.$5="SENT";this.$2=a;var c=new(b("RelayAPIRequest"))(b("RelayAPIConfig").graphBatchURI).setMethod("POST").setTrackingName("RelayGraphQLBatchRequest_"+this.$1).setData(babelHelpers["extends"]({},b("RelayGraphQLRequestUtils").getAuthenticationData(),{batch_name:this.$1,fb_api_caller_class:"RelayClassic_DEPRECATED",method:"GET",queries:JSON.stringify(this.$3),response_format:this.$4,scheduler:"phased"})).setTransportBuilder(b("RelayGraphQLRequestUtils").getTransportBuilder()).setRequestHeaders(b("RelayGraphQLRequestUtils").getRequestHeaders()).setErrorHandler(function(a){this.$6(b("RelayGraphQLRequestUtils").createErrorFromXHR(a,"Network request encountered error %s %s: %s",a.errorType,a.errorCode,a.errorMsg))}.bind(this)).setTimeoutHandler(function(){this.$6(h.createWarning("NetworkTimeoutError","Network request timed out."))}.bind(this)).setResponseFilter(i.responseFilter).setResponseChunkHandler(this.$7.bind(this)).send();return{abort:function(){this.$5!=="TERMINATED"&&(this.$5="TERMINATED",c.abort())}.bind(this)}};i.responseFilter=function(a){return a.replace(/^ +/,"").replace(/ +$/,"")};i.prototype.$7=function(a,c,d){__p&&__p();var e;try{e=b("RelayGraphQLRequestUtils").parsePayload(a)}catch(a){this.$6(a);return}if(e.error){c=b("RelayGraphQLRequestUtils").createErrorFromPayload(e.error);this.$6(c)}else d?this.$8("onCompleted"):Object.keys(e).forEach(function(c){var d=e[c],g=d.data,i=d.error,j=d.errors,a=d.exports,k=d.ref_params;d=d.response;var l=null;i?l=b("RelayGraphQLRequestUtils").createErrorFromPayload(i):j&&(l=h.create("GraphQL OSS Error","GraphQL OSS server responded with errors, see `source` for more details."),l.source=j);i={data:g,error:l,partialErrors:j,exports:a,id:c,refParams:k,response:g!==void 0?g:d};this.$8("onNext",i)}.bind(this))};i.prototype.$6=function(a){this.$8("onError",a)};i.prototype.$8=function(a){if(this.$5==="TERMINATED")return;(a==="onCompleted"||a==="onError")&&(this.$5="TERMINATED");if(this.$2){var b;for(var c=arguments.length,d=new Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this.$2)[a].apply(b,d)}};e.exports=i}),null);